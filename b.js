const data = [
  {
    tjn: 2023,
    yqjg: '精密光谱科学与技术国家重点实验室',
    jzqj: '500（含）-1000万',
    sl: 3,
    jz: 1668.05,
    rk: 1,
  },
  {
    tjn: 2023,
    yqjg: '精密光谱科学与技术国家重点实验室',
    jzqj: '100（含）-500万',
    sl: 31,
    jz: 5493.98,
    rk: 1,
  },
  {
    tjn: 2023,
    yqjg: '精密光谱科学与技术国家重点实验室',
    jzqj: '50（含）-100万',
    sl: 53,
    jz: 3770.22,
    rk: 1,
  },
  {
    tjn: 2023,
    yqjg: '精密光谱科学与技术国家重点实验室',
    jzqj: '30（含）-50万',
    sl: 49,
    jz: 1910.23,
    rk: 1,
  },
  {
    tjn: 2023,
    yqjg: '上海市绿色化学与化工过程绿色化重点实验室',
    jzqj: '500（含）-1000万',
    sl: 1,
    jz: 819.94,
    rk: 2,
  },
  {
    tjn: 2023,
    yqjg: '上海市绿色化学与化工过程绿色化重点实验室',
    jzqj: '100（含）-500万',
    sl: 15,
    jz: 3347.48,
    rk: 2,
  },
  {
    tjn: 2023,
    yqjg: '上海市绿色化学与化工过程绿色化重点实验室',
    jzqj: '50（含）-100万',
    sl: 20,
    jz: 1298.25,
    rk: 2,
  },
  {
    tjn: 2023,
    yqjg: '上海市绿色化学与化工过程绿色化重点实验室',
    jzqj: '30（含）-50万',
    sl: 19,
    jz: 750.15,
    rk: 2,
  },
  {
    tjn: 2023,
    yqjg: '河口海岸科学研究院（海洋科学学院）',
    jzqj: '100（含）-500万',
    sl: 10,
    jz: 1976.22,
    rk: 3,
  },
  {
    tjn: 2023,
    yqjg: '河口海岸科学研究院（海洋科学学院）',
    jzqj: '50（含）-100万',
    sl: 16,
    jz: 1024.64,
    rk: 3,
  },
  {
    tjn: 2023,
    yqjg: '河口海岸科学研究院（海洋科学学院）',
    jzqj: '30（含）-50万',
    sl: 13,
    jz: 518.86,
    rk: 3,
  },
  {
    tjn: 2023,
    yqjg: '化学系',
    jzqj: '500（含）-1000万',
    sl: 1,
    jz: 512.21,
    rk: 4,
  },
  {
    tjn: 2023,
    yqjg: '化学系',
    jzqj: '100（含）-500万',
    sl: 10,
    jz: 2154.71,
    rk: 4,
  },
  {
    tjn: 2023,
    yqjg: '化学系',
    jzqj: '50（含）-100万',
    sl: 12,
    jz: 872.76,
    rk: 4,
  },
  {
    tjn: 2023,
    yqjg: '化学系',
    jzqj: '30（含）-50万',
    sl: 9,
    jz: 352.03,
    rk: 4,
  },
  {
    tjn: 2023,
    yqjg: '地理科学学院',
    jzqj: '100（含）-500万',
    sl: 8,
    jz: 2070.88,
    rk: 5,
  },
  {
    tjn: 2023,
    yqjg: '地理科学学院',
    jzqj: '50（含）-100万',
    sl: 12,
    jz: 774.89,
    rk: 5,
  },
  {
    tjn: 2023,
    yqjg: '地理科学学院',
    jzqj: '30（含）-50万',
    sl: 6,
    jz: 219.1,
    rk: 5,
  },
  {
    tjn: 2023,
    yqjg: '材料科学系',
    jzqj: '100（含）-500万',
    sl: 10,
    jz: 2296.15,
    rk: 6,
  },
  {
    tjn: 2023,
    yqjg: '材料科学系',
    jzqj: '50（含）-100万',
    sl: 8,
    jz: 567.08,
    rk: 6,
  },
  {
    tjn: 2023,
    yqjg: '材料科学系',
    jzqj: '30（含）-50万',
    sl: 2,
    jz: 72.81,
    rk: 6,
  },
  {
    tjn: 2023,
    yqjg: '上海分子治疗与新药创制工程技术研究中心',
    jzqj: '100（含）-500万',
    sl: 6,
    jz: 1395.33,
    rk: 7,
  },
  {
    tjn: 2023,
    yqjg: '上海分子治疗与新药创制工程技术研究中心',
    jzqj: '50（含）-100万',
    sl: 3,
    jz: 220.68,
    rk: 7,
  },
  {
    tjn: 2023,
    yqjg: '上海分子治疗与新药创制工程技术研究中心',
    jzqj: '30（含）-50万',
    sl: 9,
    jz: 334.58,
    rk: 7,
  },
  {
    tjn: 2023,
    yqjg: '生命科学学院',
    jzqj: '100（含）-500万',
    sl: 3,
    jz: 608.82,
    rk: 8,
  },
  {
    tjn: 2023,
    yqjg: '生命科学学院',
    jzqj: '50（含）-100万',
    sl: 5,
    jz: 357.9,
    rk: 8,
  },
  {
    tjn: 2023,
    yqjg: '生命科学学院',
    jzqj: '30（含）-50万',
    sl: 8,
    jz: 315.6,
    rk: 8,
  },
  {
    tjn: 2023,
    yqjg: '脑功能基因组学教育部重点实验室',
    jzqj: '100（含）-500万',
    sl: 3,
    jz: 442.44,
    rk: 9,
  },
  {
    tjn: 2023,
    yqjg: '脑功能基因组学教育部重点实验室',
    jzqj: '50（含）-100万',
    sl: 8,
    jz: 581,
    rk: 9,
  },
  {
    tjn: 2023,
    yqjg: '脑功能基因组学教育部重点实验室',
    jzqj: '30（含）-50万',
    sl: 4,
    jz: 155.33,
    rk: 9,
  },
  {
    tjn: 2023,
    yqjg: '生命医学系',
    jzqj: '100（含）-500万',
    sl: 2,
    jz: 416.86,
    rk: 10,
  },
  {
    tjn: 2023,
    yqjg: '生命医学系',
    jzqj: '50（含）-100万',
    sl: 5,
    jz: 341.47,
    rk: 10,
  },
  {
    tjn: 2023,
    yqjg: '生命医学系',
    jzqj: '30（含）-50万',
    sl: 6,
    jz: 216.41,
    rk: 10,
  },
]

// 步骤1: 找出所有唯一的yqjg和jzqj值
const uniqueYqjg = [...new Set(data.map(item => item.yqjg))]
const uniqueJzqj = [...new Set(data.map(item => item.jzqj))]

// 步骤2: 为每个jzqj创建一个“模板”对象，每个yqjg对应的sl值初始化为0
const template = uniqueJzqj.reduce((acc, jzqj) => {
  acc[jzqj] = uniqueYqjg.reduce((yqjgAcc, yqjg) => {
    yqjgAcc[yqjg] = 0 // 初始化每个yqjg的sl值为0
    return yqjgAcc
  }, {})
  return acc
}, {})

// 步骤3: 填充模板，找到每个jzqj对应的所有yqjg的sl值
data.forEach(item => {
  template[item.jzqj][item.yqjg] = item.sl
})

// 结果转换为所需格式
const barsData = Object.entries(template).map(([jzqj, yqjgObj]) => ({
  jzqj,
  values: Object.values(yqjgObj),
}))

// 初始化一个对象来收集每个yqjg的jz值之和
const yqjgJzSum = {}

// 遍历data数组，累加每个yqjg对应的jz值
data.forEach(item => {
  // 如果当前yqjg还未添加到yqjgJzSum中，初始化为0
  if (!yqjgJzSum[item.yqjg]) {
    yqjgJzSum[item.yqjg] = 0
  }
  // 累加当前yqjg的jz值
  yqjgJzSum[item.yqjg] += item.jz
})

const lineData = uniqueYqjg.map(item => {
  return Number(yqjgJzSum[item].toFixed(2))
})

